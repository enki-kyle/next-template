#!/bin/sh

commit_msg_file=$1
commit_msg=$(cat $commit_msg_file)

# 허용되는 커밋 메시지 접두사 목록
prefixes="chore:|docs:|feat:|fix:|refactor:|delete:|typo:|add:"

# 정규식으로 커밋 메시지 형식 검사
if ! echo "$commit_msg" | grep -qE "^($prefixes)[[:space:]]"; then
  echo ""
  echo "❌ 커밋 메시지 형식 오류!"
  echo "🔷 형식: [type]: [subject]"
  echo "💡 예시: feat: 로그인 기능 추가"
  echo ""
  echo "커밋 메시지는 아래 접두사 중 하나로 시작해야 합니다:"
  echo ""
  echo "  - add      : 코드/파일/리소스 추가"
  echo "  - chore    : 빌드, 설정, 도구 변경"
  echo "  - delete   : 기존 기능 또는 파일 제거"
  echo "  - docs     : 문서 수정"
  echo "  - feat     : 새로운 기능 추가"
  echo "  - fix      : 버그 수정"
  echo "  - refactor : 기능 변경 없는 코드 리팩토링"
  echo "  - typo     : 오타, 주석, 텍스트 수정"
  echo ""
  exit 1
fi